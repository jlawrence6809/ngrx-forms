import { AddGroupControlAction, FocusAction, isNgrxFormsAction, RemoveGroupControlAction, UnfocusAction, } from '../actions';
import { isArrayState } from '../state';
import { addControlReducer } from './reducer/add-control';
import { clearAsyncErrorReducer } from './reducer/clear-async-error';
import { disableReducer } from './reducer/disable';
import { enableReducer } from './reducer/enable';
import { markAsDirtyReducer } from './reducer/mark-as-dirty';
import { markAsPristineReducer } from './reducer/mark-as-pristine';
import { markAsSubmittedReducer } from './reducer/mark-as-submitted';
import { markAsTouchedReducer } from './reducer/mark-as-touched';
import { markAsUnsubmittedReducer } from './reducer/mark-as-unsubmitted';
import { markAsUntouchedReducer } from './reducer/mark-as-untouched';
import { moveControlReducer } from './reducer/move-control';
import { removeControlReducer } from './reducer/remove-control';
import { resetReducer } from './reducer/reset';
import { setAsyncErrorReducer } from './reducer/set-async-error';
import { setErrorsReducer } from './reducer/set-errors';
import { setUserDefinedPropertyReducer } from './reducer/set-user-defined-property';
import { setValueReducer } from './reducer/set-value';
import { startAsyncValidationReducer } from './reducer/start-async-validation';
import { swapControlReducer } from './reducer/swap-control';
import { childReducer } from './reducer/util';
export function formArrayReducerInternal(state, action) {
    if (!isArrayState(state)) {
        throw new Error('The state must be an array state');
    }
    if (!isNgrxFormsAction(action)) {
        return state;
    }
    if (!action.controlId.startsWith(state.id)) {
        return state;
    }
    switch (action.type) {
        case FocusAction.TYPE:
        case UnfocusAction.TYPE:
        case AddGroupControlAction.TYPE:
        case RemoveGroupControlAction.TYPE:
            return childReducer(state, action);
        default:
            break;
    }
    state = setValueReducer(state, action);
    state = setErrorsReducer(state, action);
    state = startAsyncValidationReducer(state, action);
    state = setAsyncErrorReducer(state, action);
    state = clearAsyncErrorReducer(state, action);
    state = enableReducer(state, action);
    state = disableReducer(state, action);
    state = markAsDirtyReducer(state, action);
    state = markAsPristineReducer(state, action);
    state = markAsTouchedReducer(state, action);
    state = markAsUntouchedReducer(state, action);
    state = markAsSubmittedReducer(state, action);
    state = markAsUnsubmittedReducer(state, action);
    state = setUserDefinedPropertyReducer(state, action);
    state = resetReducer(state, action);
    state = addControlReducer(state, action);
    state = removeControlReducer(state, action);
    state = swapControlReducer(state, action);
    state = moveControlReducer(state, action);
    return state;
}
/**
 * This reducer function updates a form array state with actions.
 */
export function formArrayReducer(state, action) {
    if (!state) {
        throw new Error('The array state must be defined!');
    }
    return formArrayReducerInternal(state, action);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVkdWNlci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25ncngtZm9ybXMvIiwic291cmNlcyI6WyJzcmMvYXJyYXkvcmVkdWNlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBRUwscUJBQXFCLEVBQ3JCLFdBQVcsRUFDWCxpQkFBaUIsRUFDakIsd0JBQXdCLEVBQ3hCLGFBQWEsR0FDZCxNQUFNLFlBQVksQ0FBQztBQUNwQixPQUFPLEVBQWtCLFlBQVksRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUN4RCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUNyRSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbkQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ2pELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQzdELE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ25FLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ2pFLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzVELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUNqRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUN4RCxPQUFPLEVBQUUsNkJBQTZCLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUNwRixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDL0UsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDNUQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTlDLE1BQU0sVUFBVSx3QkFBd0IsQ0FBUyxLQUE2QixFQUFFLE1BQXlCO0lBQ3ZHLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDeEIsTUFBTSxJQUFJLEtBQUssQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDO0tBQ3JEO0lBRUQsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxFQUFFO1FBQzlCLE9BQU8sS0FBSyxDQUFDO0tBQ2Q7SUFFRCxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFFO1FBQzFDLE9BQU8sS0FBSyxDQUFDO0tBQ2Q7SUFFRCxRQUFRLE1BQU0sQ0FBQyxJQUFJLEVBQUU7UUFDbkIsS0FBSyxXQUFXLENBQUMsSUFBSSxDQUFDO1FBQ3RCLEtBQUssYUFBYSxDQUFDLElBQUksQ0FBQztRQUN4QixLQUFLLHFCQUFxQixDQUFDLElBQUksQ0FBQztRQUNoQyxLQUFLLHdCQUF3QixDQUFDLElBQUk7WUFDaEMsT0FBTyxZQUFZLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBRXJDO1lBQ0UsTUFBTTtLQUNUO0lBRUQsS0FBSyxHQUFHLGVBQWUsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDdkMsS0FBSyxHQUFHLGdCQUFnQixDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztJQUN4QyxLQUFLLEdBQUcsMkJBQTJCLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ25ELEtBQUssR0FBRyxvQkFBb0IsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDNUMsS0FBSyxHQUFHLHNCQUFzQixDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztJQUM5QyxLQUFLLEdBQUcsYUFBYSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNyQyxLQUFLLEdBQUcsY0FBYyxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztJQUN0QyxLQUFLLEdBQUcsa0JBQWtCLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQzFDLEtBQUssR0FBRyxxQkFBcUIsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDN0MsS0FBSyxHQUFHLG9CQUFvQixDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztJQUM1QyxLQUFLLEdBQUcsc0JBQXNCLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQzlDLEtBQUssR0FBRyxzQkFBc0IsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDOUMsS0FBSyxHQUFHLHdCQUF3QixDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNoRCxLQUFLLEdBQUcsNkJBQTZCLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ3JELEtBQUssR0FBRyxZQUFZLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ3BDLEtBQUssR0FBRyxpQkFBaUIsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDekMsS0FBSyxHQUFHLG9CQUFvQixDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztJQUM1QyxLQUFLLEdBQUcsa0JBQWtCLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQzFDLEtBQUssR0FBRyxrQkFBa0IsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFFMUMsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxNQUFNLFVBQVUsZ0JBQWdCLENBQVMsS0FBeUMsRUFBRSxNQUFjO0lBQ2hHLElBQUksQ0FBQyxLQUFLLEVBQUU7UUFDVixNQUFNLElBQUksS0FBSyxDQUFDLGtDQUFrQyxDQUFDLENBQUM7S0FDckQ7SUFFRCxPQUFPLHdCQUF3QixDQUFDLEtBQUssRUFBRSxNQUFhLENBQUMsQ0FBQztBQUN4RCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWN0aW9uIH0gZnJvbSAnQG5ncngvc3RvcmUnO1xuXG5pbXBvcnQge1xuICBBY3Rpb25zLFxuICBBZGRHcm91cENvbnRyb2xBY3Rpb24sXG4gIEZvY3VzQWN0aW9uLFxuICBpc05ncnhGb3Jtc0FjdGlvbixcbiAgUmVtb3ZlR3JvdXBDb250cm9sQWN0aW9uLFxuICBVbmZvY3VzQWN0aW9uLFxufSBmcm9tICcuLi9hY3Rpb25zJztcbmltcG9ydCB7IEZvcm1BcnJheVN0YXRlLCBpc0FycmF5U3RhdGUgfSBmcm9tICcuLi9zdGF0ZSc7XG5pbXBvcnQgeyBhZGRDb250cm9sUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9hZGQtY29udHJvbCc7XG5pbXBvcnQgeyBjbGVhckFzeW5jRXJyb3JSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL2NsZWFyLWFzeW5jLWVycm9yJztcbmltcG9ydCB7IGRpc2FibGVSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL2Rpc2FibGUnO1xuaW1wb3J0IHsgZW5hYmxlUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9lbmFibGUnO1xuaW1wb3J0IHsgbWFya0FzRGlydHlSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL21hcmstYXMtZGlydHknO1xuaW1wb3J0IHsgbWFya0FzUHJpc3RpbmVSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL21hcmstYXMtcHJpc3RpbmUnO1xuaW1wb3J0IHsgbWFya0FzU3VibWl0dGVkUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9tYXJrLWFzLXN1Ym1pdHRlZCc7XG5pbXBvcnQgeyBtYXJrQXNUb3VjaGVkUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9tYXJrLWFzLXRvdWNoZWQnO1xuaW1wb3J0IHsgbWFya0FzVW5zdWJtaXR0ZWRSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL21hcmstYXMtdW5zdWJtaXR0ZWQnO1xuaW1wb3J0IHsgbWFya0FzVW50b3VjaGVkUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9tYXJrLWFzLXVudG91Y2hlZCc7XG5pbXBvcnQgeyBtb3ZlQ29udHJvbFJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvbW92ZS1jb250cm9sJztcbmltcG9ydCB7IHJlbW92ZUNvbnRyb2xSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL3JlbW92ZS1jb250cm9sJztcbmltcG9ydCB7IHJlc2V0UmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9yZXNldCc7XG5pbXBvcnQgeyBzZXRBc3luY0Vycm9yUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9zZXQtYXN5bmMtZXJyb3InO1xuaW1wb3J0IHsgc2V0RXJyb3JzUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9zZXQtZXJyb3JzJztcbmltcG9ydCB7IHNldFVzZXJEZWZpbmVkUHJvcGVydHlSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL3NldC11c2VyLWRlZmluZWQtcHJvcGVydHknO1xuaW1wb3J0IHsgc2V0VmFsdWVSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL3NldC12YWx1ZSc7XG5pbXBvcnQgeyBzdGFydEFzeW5jVmFsaWRhdGlvblJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvc3RhcnQtYXN5bmMtdmFsaWRhdGlvbic7XG5pbXBvcnQgeyBzd2FwQ29udHJvbFJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvc3dhcC1jb250cm9sJztcbmltcG9ydCB7IGNoaWxkUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci91dGlsJztcblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1BcnJheVJlZHVjZXJJbnRlcm5hbDxUVmFsdWU+KHN0YXRlOiBGb3JtQXJyYXlTdGF0ZTxUVmFsdWU+LCBhY3Rpb246IEFjdGlvbnM8VFZhbHVlW10+KSB7XG4gIGlmICghaXNBcnJheVN0YXRlKHN0YXRlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignVGhlIHN0YXRlIG11c3QgYmUgYW4gYXJyYXkgc3RhdGUnKTtcbiAgfVxuXG4gIGlmICghaXNOZ3J4Rm9ybXNBY3Rpb24oYWN0aW9uKSkge1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIGlmICghYWN0aW9uLmNvbnRyb2xJZC5zdGFydHNXaXRoKHN0YXRlLmlkKSkge1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICBjYXNlIEZvY3VzQWN0aW9uLlRZUEU6XG4gICAgY2FzZSBVbmZvY3VzQWN0aW9uLlRZUEU6XG4gICAgY2FzZSBBZGRHcm91cENvbnRyb2xBY3Rpb24uVFlQRTpcbiAgICBjYXNlIFJlbW92ZUdyb3VwQ29udHJvbEFjdGlvbi5UWVBFOlxuICAgICAgcmV0dXJuIGNoaWxkUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcblxuICAgIGRlZmF1bHQ6XG4gICAgICBicmVhaztcbiAgfVxuXG4gIHN0YXRlID0gc2V0VmFsdWVSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xuICBzdGF0ZSA9IHNldEVycm9yc1JlZHVjZXIoc3RhdGUsIGFjdGlvbik7XG4gIHN0YXRlID0gc3RhcnRBc3luY1ZhbGlkYXRpb25SZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xuICBzdGF0ZSA9IHNldEFzeW5jRXJyb3JSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xuICBzdGF0ZSA9IGNsZWFyQXN5bmNFcnJvclJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XG4gIHN0YXRlID0gZW5hYmxlUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcbiAgc3RhdGUgPSBkaXNhYmxlUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcbiAgc3RhdGUgPSBtYXJrQXNEaXJ0eVJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XG4gIHN0YXRlID0gbWFya0FzUHJpc3RpbmVSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xuICBzdGF0ZSA9IG1hcmtBc1RvdWNoZWRSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xuICBzdGF0ZSA9IG1hcmtBc1VudG91Y2hlZFJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XG4gIHN0YXRlID0gbWFya0FzU3VibWl0dGVkUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcbiAgc3RhdGUgPSBtYXJrQXNVbnN1Ym1pdHRlZFJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XG4gIHN0YXRlID0gc2V0VXNlckRlZmluZWRQcm9wZXJ0eVJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XG4gIHN0YXRlID0gcmVzZXRSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xuICBzdGF0ZSA9IGFkZENvbnRyb2xSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xuICBzdGF0ZSA9IHJlbW92ZUNvbnRyb2xSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xuICBzdGF0ZSA9IHN3YXBDb250cm9sUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcbiAgc3RhdGUgPSBtb3ZlQ29udHJvbFJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XG5cbiAgcmV0dXJuIHN0YXRlO1xufVxuXG4vKipcbiAqIFRoaXMgcmVkdWNlciBmdW5jdGlvbiB1cGRhdGVzIGEgZm9ybSBhcnJheSBzdGF0ZSB3aXRoIGFjdGlvbnMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JtQXJyYXlSZWR1Y2VyPFRWYWx1ZT4oc3RhdGU6IEZvcm1BcnJheVN0YXRlPFRWYWx1ZT4gfCB1bmRlZmluZWQsIGFjdGlvbjogQWN0aW9uKSB7XG4gIGlmICghc3RhdGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBhcnJheSBzdGF0ZSBtdXN0IGJlIGRlZmluZWQhJyk7XG4gIH1cblxuICByZXR1cm4gZm9ybUFycmF5UmVkdWNlckludGVybmFsKHN0YXRlLCBhY3Rpb24gYXMgYW55KTtcbn1cbiJdfQ==
import * as tslib_1 from "tslib";
import { isBoxed } from './boxing';
import { deepEquals, isEmpty } from './util';
/**
 * This function determines if a value is a form state.
 */
export function isFormState(state) {
    return !!state && state.hasOwnProperty('id') && state.hasOwnProperty('value') && state.hasOwnProperty('errors');
}
/**
 * This function determines if a value is an array state.
 */
export function isArrayState(state) {
    return isFormState(state) && state.hasOwnProperty('controls') && Array.isArray(state.controls);
}
/**
 * This function determines if a value is a group state.
 */
export function isGroupState(state) {
    return isFormState(state) && state.hasOwnProperty('controls') && !Array.isArray(state.controls) && typeof state.controls !== 'function';
}
export function createChildState(id, childValue) {
    if (isBoxed(childValue)) {
        return createFormControlState(id, childValue);
    }
    if (childValue !== null && Array.isArray(childValue)) {
        return createFormArrayState(id, childValue);
    }
    if (childValue !== null && typeof childValue === 'object') {
        return createFormGroupState(id, childValue);
    }
    return createFormControlState(id, childValue);
}
export function verifyFormControlValueIsValid(value) {
    if (value === null || ['string', 'number', 'boolean', 'undefined'].indexOf(typeof value) >= 0) {
        return value;
    }
    if (!isBoxed(value)) {
        var errorMsg = 'Form control states only support undefined, null, string, number, and boolean values as well as boxed values';
        throw new Error(errorMsg + "; got " + JSON.stringify(value) + " of type " + typeof value); // `;
    }
    if (value.value === null || ['string', 'number', 'boolean', 'undefined'].indexOf(typeof value.value) >= 0) {
        return value;
    }
    var serialized = JSON.stringify(value);
    var deserialized = JSON.parse(serialized);
    if (deepEquals(value, deserialized)) {
        return value;
    }
    throw new Error("A form control value must be serializable (i.e. value === JSON.parse(JSON.stringify(value))), got: " + JSON.stringify(value));
}
/**
 * This function creates a form control state with an ID and a value.
 */
export function createFormControlState(id, value) {
    return {
        id: id,
        value: verifyFormControlValueIsValid(value),
        errors: {},
        pendingValidations: [],
        isValidationPending: false,
        isValid: true,
        isInvalid: false,
        isEnabled: true,
        isDisabled: false,
        isDirty: false,
        isPristine: true,
        isTouched: false,
        isUntouched: true,
        isSubmitted: false,
        isUnsubmitted: true,
        isFocused: false,
        isUnfocused: true,
        userDefinedProperties: {},
    };
}
export function getFormGroupValue(controls, originalValue) {
    var hasChanged = Object.keys(originalValue).length !== Object.keys(controls).length;
    var newValue = Object.keys(controls).reduce(function (res, key) {
        hasChanged = hasChanged || originalValue[key] !== controls[key].value;
        res[key] = controls[key].value;
        return res;
    }, {});
    return hasChanged ? newValue : originalValue;
}
export function getFormGroupErrors(controls, originalErrors) {
    var hasChanged = false;
    var groupErrors = Object.keys(originalErrors)
        .filter(function (key) { return !key.startsWith('_'); })
        .reduce(function (res, key) {
        var _a;
        return Object.assign(res, (_a = {}, _a[key] = originalErrors[key], _a));
    }, {});
    var newErrors = Object.keys(controls).reduce(function (res, key) {
        var _a;
        var controlErrors = controls[key].errors;
        if (!isEmpty(controlErrors)) {
            hasChanged = hasChanged || originalErrors["_" + key] !== controlErrors;
            Object.assign(res, (_a = {}, _a["_" + key] = controls[key].errors, _a));
        }
        else {
            hasChanged = hasChanged || originalErrors.hasOwnProperty("_" + key);
        }
        return res;
    }, groupErrors);
    hasChanged = hasChanged || Object.keys(originalErrors).length !== Object.keys(newErrors).length;
    return hasChanged ? newErrors : originalErrors;
}
export function computeGroupState(id, controls, value, errors, pendingValidations, userDefinedProperties, flags) {
    value = getFormGroupValue(controls, value);
    errors = getFormGroupErrors(controls, errors);
    var isValid = isEmpty(errors);
    var isDirty = flags.wasOrShouldBeDirty || Object.keys(controls).some(function (key) { return controls[key].isDirty; });
    var isEnabled = flags.wasOrShouldBeEnabled || Object.keys(controls).some(function (key) { return controls[key].isEnabled; });
    var isTouched = flags.wasOrShouldBeTouched || Object.keys(controls).some(function (key) { return controls[key].isTouched; });
    var isSubmitted = flags.wasOrShouldBeSubmitted || Object.keys(controls).some(function (key) { return controls[key].isSubmitted; });
    var isValidationPending = pendingValidations.length > 0 || Object.keys(controls).some(function (key) { return controls[key].isValidationPending; });
    return {
        id: id,
        value: value,
        errors: errors,
        pendingValidations: pendingValidations,
        isValidationPending: isValidationPending,
        isValid: isValid,
        isInvalid: !isValid,
        isEnabled: isEnabled,
        isDisabled: !isEnabled,
        isDirty: isDirty,
        isPristine: !isDirty,
        isTouched: isTouched,
        isUntouched: !isTouched,
        isSubmitted: isSubmitted,
        isUnsubmitted: !isSubmitted,
        userDefinedProperties: userDefinedProperties,
        controls: controls,
    };
}
/**
 * This function creates a form group state with an ID and a value.
 * From the value the shape of the group state is inferred, i.e.
 * object properties are inferred as form groups, array properties
 * are inferred as form arrays, and primitive properties are inferred
 * as form controls.
 */
export function createFormGroupState(id, initialValue) {
    var controls = Object.keys(initialValue)
        .map(function (key) { return [key, createChildState(id + "." + key, initialValue[key])]; })
        .reduce(function (res, _a) {
        var _b;
        var _c = tslib_1.__read(_a, 2), controlId = _c[0], state = _c[1];
        return Object.assign(res, (_b = {}, _b[controlId] = state, _b));
    }, {});
    return computeGroupState(id, controls, initialValue, {}, [], {}, { wasOrShouldBeEnabled: true });
}
function getFormArrayValue(controls, originalValue) {
    var hasChanged = Object.keys(originalValue).length !== Object.keys(controls).length;
    var newValue = controls.map(function (state, i) {
        hasChanged = hasChanged || originalValue[i] !== state.value;
        return state.value;
    });
    return hasChanged ? newValue : originalValue;
}
function getFormArrayErrors(controls, originalErrors) {
    var hasChanged = false;
    var groupErrors = Object.keys(originalErrors)
        .filter(function (key) { return !key.startsWith('_'); })
        .reduce(function (res, key) {
        var _a;
        return Object.assign(res, (_a = {}, _a[key] = originalErrors[key], _a));
    }, {});
    var newErrors = controls.reduce(function (res, state, i) {
        var _a;
        var controlErrors = state.errors;
        if (!isEmpty(controlErrors)) {
            hasChanged = hasChanged || originalErrors["_" + i] !== controlErrors;
            Object.assign(res, (_a = {}, _a["_" + i] = controlErrors, _a));
        }
        else {
            hasChanged = hasChanged || originalErrors.hasOwnProperty("_" + i);
        }
        return res;
    }, groupErrors);
    hasChanged = hasChanged || Object.keys(originalErrors).length !== Object.keys(newErrors).length;
    return hasChanged ? newErrors : originalErrors;
}
export function computeArrayState(id, inferredControls, value, errors, pendingValidations, userDefinedProperties, flags) {
    var controls = inferredControls;
    value = getFormArrayValue(controls, value);
    errors = getFormArrayErrors(controls, errors);
    var isValid = isEmpty(errors);
    var isDirty = flags.wasOrShouldBeDirty || controls.some(function (state) { return state.isDirty; });
    var isEnabled = flags.wasOrShouldBeEnabled || controls.some(function (state) { return state.isEnabled; });
    var isTouched = flags.wasOrShouldBeTouched || controls.some(function (state) { return state.isTouched; });
    var isSubmitted = flags.wasOrShouldBeSubmitted || controls.some(function (state) { return state.isSubmitted; });
    var isValidationPending = pendingValidations.length > 0 || controls.some(function (state) { return state.isValidationPending; });
    return {
        id: id,
        value: value,
        errors: errors,
        pendingValidations: pendingValidations,
        isValidationPending: isValidationPending,
        isValid: isValid,
        isInvalid: !isValid,
        isEnabled: isEnabled,
        isDisabled: !isEnabled,
        isDirty: isDirty,
        isPristine: !isDirty,
        isTouched: isTouched,
        isUntouched: !isTouched,
        isSubmitted: isSubmitted,
        isUnsubmitted: !isSubmitted,
        userDefinedProperties: userDefinedProperties,
        controls: inferredControls,
    };
}
/**
 * This function creates a form array state with an ID and a value.
 * From the value the shape of the array state is inferred, i.e.
 * object values are inferred as form groups, array values
 * are inferred as form arrays, and primitive values are inferred
 * as form controls.
 */
export function createFormArrayState(id, initialValue) {
    var controls = initialValue
        .map(function (value, i) { return createChildState(id + "." + i, value); });
    return computeArrayState(id, controls, initialValue, {}, [], {}, { wasOrShouldBeEnabled: true });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdGUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3J4LWZvcm1zLyIsInNvdXJjZXMiOlsic3JjL3N0YXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQVMsT0FBTyxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQzFDLE9BQU8sRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLE1BQU0sUUFBUSxDQUFDO0FBNmtCN0M7O0dBRUc7QUFDSCxNQUFNLFVBQVUsV0FBVyxDQUFlLEtBQVU7SUFDbEQsT0FBTyxDQUFDLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsSUFBSSxLQUFLLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ2xILENBQUM7QUFFRDs7R0FFRztBQUNILE1BQU0sVUFBVSxZQUFZLENBQWUsS0FBVTtJQUNuRCxPQUFPLFdBQVcsQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUUsS0FBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQzFHLENBQUM7QUFFRDs7R0FFRztBQUNILE1BQU0sVUFBVSxZQUFZLENBQWUsS0FBVTtJQUNuRCxPQUFPLFdBQVcsQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBRSxLQUFhLENBQUMsUUFBUSxDQUFDLElBQUksT0FBUSxLQUFhLENBQUMsUUFBUSxLQUFLLFVBQVUsQ0FBQztBQUM1SixDQUFDO0FBRUQsTUFBTSxVQUFVLGdCQUFnQixDQUFTLEVBQVUsRUFBRSxVQUFrQjtJQUNyRSxJQUFJLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFBRTtRQUN2QixPQUFPLHNCQUFzQixDQUFNLEVBQUUsRUFBRSxVQUFVLENBQXNCLENBQUM7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Ym94aW5nJztcbmltcG9ydCB7IGRlZXBFcXVhbHMsIGlzRW1wdHkgfSBmcm9tICcuL3V0aWwnO1xuXG5leHBvcnQgdHlwZSBGb3JtQ29udHJvbFZhbHVlVHlwZXMgPSBCb3hlZDxhbnk+IHwgc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiB8IG51bGwgfCB1bmRlZmluZWQ7XG5leHBvcnQgdHlwZSBOZ3J4Rm9ybUNvbnRyb2xJZCA9IHN0cmluZztcblxuLyoqXG4gKiBUaGlzIHR5cGUgcmVwcmVzZW50cyBhIGNvbGxlY3Rpb24gb2YgbmFtZWQgZXJyb3JzLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25FcnJvcnMgeyByZWFkb25seSBba2V5OiBzdHJpbmddOiBhbnk7IH1cbmV4cG9ydCBpbnRlcmZhY2UgS2V5VmFsdWUgeyBba2V5OiBzdHJpbmddOiBhbnk7IH1cblxuLyoqXG4gKiBCYXNlIGludGVyZmFjZSBmb3IgYWxsIHR5cGVzIG9mIGZvcm0gc3RhdGVzLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEFic3RyYWN0Q29udHJvbFN0YXRlPFRWYWx1ZT4ge1xuICAvKipcbiAgICogVGhlIHVuaXF1ZSBJRCBvZiB0aGUgZm9ybSBzdGF0ZS4gVXN1YWxseSB0aGlzIGlzIHRoZSBuYW1lIG9yIGluZGV4XG4gICAqIG9mIHRoZSBjb250cm9sIGluIHRoZSBmb3JtIHZhbHVlIHByZWZpeGVkIGJ5IHRoZSBJRCBvZiB0aGUgY29udGFpbmluZ1xuICAgKiBncm91cCBvciBhcnJheSwgZS5nLiBgTVlfRk9STS5zb21lVGV4dElucHV0YCBvciBgTVlfRk9STS4wYC5cbiAgICovXG4gIHJlYWRvbmx5IGlkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSB2YWx1ZSBvZiB0aGUgZm9ybSBzdGF0ZS5cbiAgICovXG4gIHJlYWRvbmx5IHZhbHVlOiBUVmFsdWU7XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGlmIHRoZSBzdGF0ZSBkb2VzIG5vdCBoYXZlIGFueSBlcnJvcnMuXG4gICAqL1xuICByZWFkb25seSBpc1ZhbGlkOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBpZiB0aGUgc3RhdGUgaGFzIGF0IGxlYXN0IG9uZSBlcnJvci5cbiAgICovXG4gIHJlYWRvbmx5IGlzSW52YWxpZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhlIGVycm9ycyBvZiB0aGUgc3RhdGUuIFRoaXMgcHJvcGVydHkgYWx3YXlzIGhhcyBhIHZhbHVlLlxuICAgKiBJZiB0aGUgc3RhdGUgaGFzIG5vIGVycm9ycyB0aGUgcHJvcGVydHkgaXMgc2V0IHRvIGB7fWAuXG4gICAqL1xuICByZWFkb25seSBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcnM7XG5cbiAgLyoqXG4gICAqIFRoZSBuYW1lcyBvZiBhbGwgYXN5bmNocm9ub3VzIHZhbGlkYXRpb25zIGN1cnJlbnRseSBydW5uaW5nXG4gICAqIGZvciB0aGUgc3RhdGUuXG4gICAqL1xuICByZWFkb25seSBwZW5kaW5nVmFsaWRhdGlvbnM6IHJlYWRvbmx5IHN0cmluZ1tdO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGluZGljYXRlcyB3aGV0aGVyIHRoZSBjb250cm9sIGlzIGN1cnJlbnRseSBiZWluZ1xuICAgKiBhc3luY2hyb25vdXNseSB2YWxpZGF0ZWQuXG4gICAqL1xuICByZWFkb25seSBpc1ZhbGlkYXRpb25QZW5kaW5nOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGluZGljYXRlcyB3aGV0aGVyIHRoZSBzdGF0ZSBpcyBlbmFibGVkLiBXaGVuIGl0XG4gICAqIGlzIGBmYWxzZWAgdGhlIGBlcnJvcnNgIGFyZSBhbHdheXMgYHt9YCAoaS5lLiB0aGUgc3RhdGUgaXNcbiAgICogYWx3YXlzIHZhbGlkIGlmIGRpc2FibGVkKSBhbmQgYHBlbmRpbmdWYWxpZGF0aW9uc2AgaXMgYWx3YXlzIGBbXWBcbiAgICogKGkuZS4gYWxsIHBlbmRpbmcgdmFsaWRhdGlvbnMgYXJlIGNhbmNlbGxlZCkuXG4gICAqL1xuICByZWFkb25seSBpc0VuYWJsZWQ6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN0YXRlIGlzIGRpc2FibGVkLiBXaGVuIGl0XG4gICAqIGlzIGB0cnVlYCB0aGUgYGVycm9yc2AgYXJlIGFsd2F5cyBge31gIChpLmUuIHRoZSBzdGF0ZSBpc1xuICAgKiBhbHdheXMgdmFsaWQgaWYgZGlzYWJsZWQpIGFuZCBgcGVuZGluZ1ZhbGlkYXRpb25zYCBpcyBhbHdheXMgYFtdYFxuICAgKiAoaS5lLiBhbGwgcGVuZGluZyB2YWxpZGF0aW9ucyBhcmUgY2FuY2VsbGVkKS5cbiAgICovXG4gIHJlYWRvbmx5IGlzRGlzYWJsZWQ6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgc2V0IHRvIGB0cnVlYCBhcyBzb29uIGFzIHRoZSBzdGF0ZSdzIHZhbHVlIGNoYW5nZXMuXG4gICAqL1xuICByZWFkb25seSBpc0RpcnR5OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBhcyBsb25nIGFzIHRoZSBzdGF0ZSdzIHZhbHVlIG5ldmVyIGNoYW5nZWQuXG4gICAqL1xuICByZWFkb25seSBpc1ByaXN0aW5lOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIHNldCB0byBgdHJ1ZWAgYXMgc29vbiBhcyB0aGUgc3RhdGUgaXMgdG91Y2hlZC5cbiAgICovXG4gIHJlYWRvbmx5IGlzVG91Y2hlZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgYXMgbG9uZyBhcyB0aGUgc3RhdGUgaXMgbm90IHRvdWNoZWQuXG4gICAqL1xuICByZWFkb25seSBpc1VudG91Y2hlZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBzZXQgdG8gYHRydWVgIGFzIHNvb24gYXMgdGhlIHN0YXRlIGlzIHN1Ym1pdHRlZC5cbiAgICovXG4gIHJlYWRvbmx5IGlzU3VibWl0dGVkOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBhcyBsb25nIGFzIHRoZSBzdGF0ZSBpcyBub3Qgc3VibWl0dGVkLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNVbnN1Ym1pdHRlZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBhIGNvbnRhaW5lciBmb3IgdXNlci1kZWZpbmVkIG1ldGFkYXRhIChlLmcuIGlmXG4gICAqIHlvdSB3YW50ZWQgdG8gY291bnQgdGhlIG51bWJlciBvZiB0aW1lcyBhIHN0YXRlJ3MgdmFsdWUgaGFzIGJlZW5cbiAgICogY2hhbmdlZCwgd2hhdCBrZXlzIHdlcmUgcHJlc3NlZCBvbiBhbiBpbnB1dCwgb3IgaG93IG9mdGVuIGEgZm9ybVxuICAgKiBoYXMgYmVlbiBzdWJtaXR0ZWQgZXRjLikuIFdoaWxlIGl0IGlzIHBvc3NpYmxlIHRvIHN0b3JlIHRoaXMga2luZFxuICAgKiBvZiBpbmZvcm1hdGlvbiBvdXRzaWRlIG9mICoqbmdyeC1mb3JtcyoqIGluIHlvdXIgb3duIHN0YXRlIHRoZVxuICAgKiBgdXNlckRlZmluZWRQcm9wZXJ0aWVzYCBhbGxvdyB5b3UgdG8gc3RvcmUgeW91ciBvd24gbWV0YWRhdGFcbiAgICogZGlyZWN0bHkgaW4gdGhlIHN0YXRlLlxuICAgKi9cbiAgcmVhZG9ubHkgdXNlckRlZmluZWRQcm9wZXJ0aWVzOiBLZXlWYWx1ZTtcbn1cblxuLyoqXG4gKiBTdGF0ZSBhc3NvY2lhdGVkIHdpdGggYSBmb3JtIGNvbnRyb2wsIGkuZS4gYW4gSFRNTCBmb3JtXG4gKiBlbGVtZW50IGluIHRoZSB2aWV3IChlLmcuIGBpbnB1dGAsIGBzZWxlY3RgLCBgdGV4dGFyZWFgIGV0Yy4pLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvcm1Db250cm9sU3RhdGU8VFZhbHVlIGV4dGVuZHMgRm9ybUNvbnRyb2xWYWx1ZVR5cGVzPiBleHRlbmRzIEFic3RyYWN0Q29udHJvbFN0YXRlPFRWYWx1ZT4ge1xuICAvKipcbiAgICogVGhlIHZhbHVlIG9mIHRoZSBmb3JtIHN0YXRlLiBGb3JtIGNvbnRyb2xzIG9ubHkgc3VwcG9ydCB2YWx1ZXMgb2ZcbiAgICogdHlwZSBgc3RyaW5nYCwgYG51bWJlcmAsIGBib29sZWFuYCwgYG51bGxgLCBhbmQgYHVuZGVmaW5lZGAgdG9cbiAgICoga2VlcCB0aGUgc3RhdGUgc3RyaW5nIHNlcmlhbGl6YWJsZS5cbiAgICovXG4gIHJlYWRvbmx5IHZhbHVlOiBUVmFsdWU7XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGlmIHRoZSBmb3JtIGNvbnRyb2wgZG9lcyBub3QgaGF2ZSBhbnkgZXJyb3JzLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNWYWxpZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgdGhlIGZvcm0gY29udHJvbCBoYXMgYXQgbGVhc3Qgb25lIGVycm9yLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNJbnZhbGlkOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGUgZXJyb3JzIG9mIHRoZSBmb3JtIGNvbnRyb2wuIFRoaXMgcHJvcGVydHkgYWx3YXlzIGhhcyBhIHZhbHVlLlxuICAgKiBJZiB0aGUgY29udHJvbCBoYXMgbm8gZXJyb3JzIHRoZSBwcm9wZXJ0eSBpcyBzZXQgdG8gYHt9YC5cbiAgICovXG4gIHJlYWRvbmx5IGVycm9yczogVmFsaWRhdGlvbkVycm9ycztcblxuICAvKipcbiAgICogVGhlIG5hbWVzIG9mIGFsbCBhc3luY2hyb25vdXMgdmFsaWRhdGlvbnMgY3VycmVudGx5IHJ1bm5pbmcgZm9yIHRoZVxuICAgKiBmb3JtIGNvbnRyb2wuXG4gICAqL1xuICByZWFkb25seSBwZW5kaW5nVmFsaWRhdGlvbnM6IHJlYWRvbmx5IHN0cmluZ1tdO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGluZGljYXRlcyB3aGV0aGVyIHRoZSBjb250cm9sIGlzIGN1cnJlbnRseSBiZWluZ1xuICAgKiBhc3luY2hyb25vdXNseSB2YWxpZGF0ZWQgKGkuZS4gdGhpcyBpcyBgdHJ1ZWAgaWYgYW5kIG9ubHkgaWZcbiAgICogYHBlbmRpbmdWYWxpZGF0aW9uc2AgaXMgbm90IGVtcHR5KS5cbiAgICovXG4gIHJlYWRvbmx5IGlzVmFsaWRhdGlvblBlbmRpbmc6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIGZvcm0gY29udHJvbCBpcyBlbmFibGVkLlxuICAgKiBXaGVuIGl0IGlzIGBmYWxzZWAgdGhlIGBlcnJvcnNgIGFyZSBhbHdheXMgYHt9YCAoaS5lLiB0aGUgZm9ybVxuICAgKiBjb250cm9sIGlzIGFsd2F5cyB2YWxpZCBpZiBkaXNhYmxlZCkgYW5kIGBwZW5kaW5nVmFsaWRhdGlvbnNgXG4gICAqIGlzIGFsd2F5cyBgW11gIChpLmUuIGFsbCBwZW5kaW5nIHZhbGlkYXRpb25zIGFyZSBjYW5jZWxsZWQpLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNFbmFibGVkOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGluZGljYXRlcyB3aGV0aGVyIHRoZSBmb3JtIGNvbnRyb2wgaXMgZGlzYWJsZWQuXG4gICAqIFdoZW4gaXQgaXMgYHRydWVgIHRoZSBgZXJyb3JzYCBhcmUgYWx3YXlzIGB7fWAgKGkuZS4gdGhlIGZvcm1cbiAgICogY29udHJvbCBpcyBhbHdheXMgdmFsaWQgaWYgZGlzYWJsZWQpIGFuZCBgcGVuZGluZ1ZhbGlkYXRpb25zYFxuICAgKiBpcyBhbHdheXMgYFtdYCAoaS5lLiBhbGwgcGVuZGluZyB2YWxpZGF0aW9ucyBhcmUgY2FuY2VsbGVkKS5cbiAgICovXG4gIHJlYWRvbmx5IGlzRGlzYWJsZWQ6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgc2V0IHRvIGB0cnVlYCBhcyBzb29uIGFzIHRoZSB1bmRlcmx5aW5nXG4gICAqIGBGb3JtVmlld0FkYXB0ZXJgIG9yIGBDb250cm9sVmFsdWVBY2Nlc3NvcmAgcmVwb3J0cyBhIG5ld1xuICAgKiB2YWx1ZSBmb3IgdGhlIGZpcnN0IHRpbWUuXG4gICAqL1xuICByZWFkb25seSBpc0RpcnR5OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBhcyBsb25nIGFzIHRoZSB1bmRlcmx5aW5nXG4gICAqIGBGb3JtVmlld0FkYXB0ZXJgIG9yIGBDb250cm9sVmFsdWVBY2Nlc3NvcmAgaGFzIG5ldmVyXG4gICAqIHJlcG9ydGVkIGEgbmV3IHZhbHVlLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNQcmlzdGluZTogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBzZXQgdG8gYHRydWVgIGJhc2VkIG9uIHRoZSBydWxlcyBvZiB0aGVcbiAgICogdW5kZXJseWluZyBgRm9ybVZpZXdBZGFwdGVyYCAodXN1YWxseSBvbiBgYmx1cmAgZm9yIG1vc3QgZm9ybVxuICAgKiBlbGVtZW50cykuXG4gICAqL1xuICByZWFkb25seSBpc1RvdWNoZWQ6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGFzIGxvbmcgYXMgdGhlIGNvbnRyb2wgaXMgbm90IHRvdWNoZWQuXG4gICAqL1xuICByZWFkb25seSBpc1VudG91Y2hlZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBzZXQgdG8gYHRydWVgIGFzIHNvb24gYXMgdGhlIGdyb3VwIG9yIGFycmF5XG4gICAqIGNvbnRhaW5pbmcgdGhpcyBmb3JtIGNvbnRyb2wgaXMgc3VibWl0dGVkLiBBIGZvcm0gY29udHJvbCBjYW5cbiAgICogbmV2ZXIgYmUgc3VibWl0dGVkIG9uIGl0cyBvd24uXG4gICAqL1xuICByZWFkb25seSBpc1N1Ym1pdHRlZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgYXMgbG9uZyBhcyB0aGUgc3RhdGUgaXMgbm90IHN1Ym1pdHRlZC5cbiAgICovXG4gIHJlYWRvbmx5IGlzVW5zdWJtaXR0ZWQ6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgc2V0IHRvIGB0cnVlYCBpZiB0aGUgZm9ybSBjb250cm9sIGN1cnJlbnRseVxuICAgKiBoYXMgZm9jdXMuIFRoaXMgZmVhdHVyZSBpcyBvcHQtaW4uIFRvIGVuYWJsZSBpdCB5b3UgaGF2ZSB0b1xuICAgKiBlbmFibGUgaXQgZm9yIGEgZ2l2ZW4gZm9ybSBlbGVtZW50IGxpa2UgdGhpczpcbiAgICpcbmBgYGh0bWxcbjxpbnB1dCBbbmdyeEZvcm1Db250cm9sU3RhdGVdPVwic3RhdGVcIlxuICAgICAgW25ncnhFbmFibGVGb2N1c1RyYWNraW5nXT1cInRydWVcIiAvPlxuYGBgXG4gICAqL1xuICByZWFkb25seSBpc0ZvY3VzZWQ6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGlmIHRoZSBjb250cm9sIGN1cnJlbnRseSBkb2VzIG5vdCBoYXZlXG4gICAqIGZvY3VzIG9yIGZvY3VzIHRyYWNraW5nIGlzIG5vdCBlbmFibGVkIGZvciB0aGUgZm9ybSBjb250cm9sLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNVbmZvY3VzZWQ6IGJvb2xlYW47XG59XG5cbi8qKlxuICogVGhpcyB0eXBlIHJlcHJlc2VudHMgdGhlIGNoaWxkIGNvbnRyb2wgc3RhdGVzIG9mIGEgZm9ybSBncm91cC5cbiAqL1xuZXhwb3J0IHR5cGUgRm9ybUdyb3VwQ29udHJvbHM8VFZhbHVlPiA9IHtcbiAgcmVhZG9ubHkgW2NvbnRyb2xJZCBpbiBrZXlvZiBUVmFsdWVdOiBGb3JtU3RhdGU8VFZhbHVlW2NvbnRyb2xJZF0+O1xufTtcblxuLyoqXG4gKiBGb3JtIGdyb3VwcyBhcmUgY29sbGVjdGlvbnMgb2YgbmFtZWQgY29udHJvbHMuIEp1c3QgbGlrZSBjb250cm9sc1xuICogZ3JvdXBzIGFyZSByZXByZXNlbnRlZCBhcyBwbGFpbiBzdGF0ZSBvYmplY3RzLiBUaGUgc3RhdGUgb2YgYVxuICogZ3JvdXAgaXMgZGV0ZXJtaW5lZCBhbG1vc3QgZnVsbHkgYnkgaXRzIGNoaWxkIHN0YXRlcy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGb3JtR3JvdXBTdGF0ZTxUVmFsdWUgZXh0ZW5kcyBLZXlWYWx1ZT4gZXh0ZW5kcyBBYnN0cmFjdENvbnRyb2xTdGF0ZTxUVmFsdWU+IHtcbiAgLyoqXG4gICAqIFRoZSBhZ2dyZWdhdGVkIHZhbHVlIG9mIHRoZSBmb3JtIGdyb3VwLiBUaGUgdmFsdWUgaXMgY29tcHV0ZWQgYnlcbiAgICogYWdncmVnYXRpbmcgdGhlIHZhbHVlcyBvZiBhbGwgY2hpbGRyZW4sIGUuZy5cbiAgICpcbmBgYHR5cGVzY3JpcHRcbntcbiAgY2hpbGQxOiAnc29tZSB2YWx1ZScsXG4gIGNoaWxkMjoge1xuICAgIG5lc3RlZENoaWxkOiAxMCxcbiAgfSxcbn1cbmBgYFxuICAgKi9cbiAgcmVhZG9ubHkgdmFsdWU6IFRWYWx1ZTtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgdGhlIGZvcm0gZ3JvdXAgZG9lcyBub3QgaGF2ZSBhbnkgZXJyb3JzXG4gICAqIGl0c2VsZiBhbmQgbm9uZSBvZiBpdHMgY2hpbGRyZW4gaGF2ZSBhbnkgZXJyb3JzLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNWYWxpZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgdGhlIGZvcm0gZ3JvdXAgb3IgYW55IG9mIGl0cyBjaGlsZHJlblxuICAgKiBoYXZlIGF0IGxlYXN0IG9uZSBlcnJvci5cbiAgICovXG4gIHJlYWRvbmx5IGlzSW52YWxpZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhlIGVycm9ycyBvZiB0aGUgZm9ybSBncm91cC4gVGhpcyBwcm9wZXJ0eSBpcyBjb21wdXRlZCBieSBtZXJnaW5nXG4gICAqIHRoZSBlcnJvcnMgb2YgdGhlIGdyb3VwIHdpdGggdGhlIGVycm9ycyBvZiBhbGwgaXRzIGNoaWxkcmVuIHdoZXJlXG4gICAqIHRoZSBjaGlsZCBlcnJvcnMgYXJlIGEgcHJvcGVydHkgb2YgdGhlIGBlcnJvcnNgIG9iamVjdCBwcmVmaXhlZCB3aXRoXG4gICAqIGFuIHVuZGVyc2NvcmUsIGUuZy5cbiAgICpcbmBgYFxue1xuICBncm91cEVycm9yOiB0cnVlLFxuICBfY2hpbGQ6IHtcbiAgICBjaGlsZEVycm9yOiB0cnVlLFxuICB9LFxufVxuYGBgXG4gICAqXG4gICAqIElmIG5laXRoZXIgdGhlIGdyb3VwIG5vciBhbnkgY2hpbGRyZW4gaGF2ZSBlcnJvcnMgdGhlIHByb3BlcnR5IGlzXG4gICAqIHNldCB0byBge31gLlxuICAgKi9cbiAgcmVhZG9ubHkgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JzO1xuXG4gIC8qKlxuICAgKiBUaGUgbmFtZXMgb2YgYWxsIGFzeW5jaHJvbm91cyB2YWxpZGF0aW9ucyBjdXJyZW50bHkgcnVubmluZyBmb3IgdGhlXG4gICAqIGZvcm0gZ3JvdXAuXG4gICAqL1xuICByZWFkb25seSBwZW5kaW5nVmFsaWRhdGlvbnM6IHJlYWRvbmx5IHN0cmluZ1tdO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGluZGljYXRlcyB3aGV0aGVyIHRoZSBncm91cCBvciBhbnkgb2YgaXRzIGNoaWxkcmVuXG4gICAqIGFyZSBjdXJyZW50bHkgYmVpbmcgYXN5bmNocm9ub3VzbHkgdmFsaWRhdGVkLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNWYWxpZGF0aW9uUGVuZGluZzogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpbmRpY2F0ZXMgd2hldGhlciB0aGUgZm9ybSBncm91cCBpcyBlbmFibGVkLiBJdCBpc1xuICAgKiBgdHJ1ZWAgaWYgYW5kIG9ubHkgaWYgYXQgbGVhc3Qgb25lIG9mIGl0cyBjaGlsZCBzdGF0ZXMgaXNcbiAgICogZW5hYmxlZC4gV2hlbiBpdCBpcyBgZmFsc2VgIHRoZSBgZXJyb3JzYCBhcmUgYWx3YXlzIGB7fWAgKGkuZS5cbiAgICogdGhlIGZvcm0gZ3JvdXAgaXMgYWx3YXlzIHZhbGlkIGlmIGRpc2FibGVkKSBhbmQgYHBlbmRpbmdWYWxpZGF0aW9uc2BcbiAgICogaXMgYWx3YXlzIGBbXWAgKGkuZS4gYWxsIHBlbmRpbmcgdmFsaWRhdGlvbnMgYXJlIGNhbmNlbGxlZCkuXG4gICAqL1xuICByZWFkb25seSBpc0VuYWJsZWQ6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIGZvcm0gZ3JvdXAgaXMgZGlzYWJsZWQuIEl0IGlzXG4gICAqIGB0cnVlYCBpZiBhbmQgb25seSBpZiBhbGwgb2YgaXRzIGNoaWxkIHN0YXRlIGFyZSBkaXNhYmxlZC4gV2hlblxuICAgKiBpdCBpcyBgdHJ1ZWAgdGhlIGBlcnJvcnNgIGFyZSBhbHdheXMgYHt9YCAoaS5lLiB0aGUgZm9ybSBncm91cFxuICAgKiBpcyBhbHdheXMgdmFsaWQgaWYgZGlzYWJsZWQpIGFuZCBgcGVuZGluZ1ZhbGlkYXRpb25zYCBpcyBhbHdheXNcbiAgICogYFtdYCAoaS5lLiBhbGwgcGVuZGluZyB2YWxpZGF0aW9ucyBhcmUgY2FuY2VsbGVkKS5cbiAgICovXG4gIHJlYWRvbmx5IGlzRGlzYWJsZWQ6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGlmIGFuZCBvbmx5IGlmIGF0IGxlYXN0IG9uZSBvZiB0aGUgZm9ybVxuICAgKiBncm91cCdzIGNoaWxkIHN0YXRlcyBpcyBtYXJrZWQgYXMgZGlydHkuXG4gICAqL1xuICByZWFkb25seSBpc0RpcnR5OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBpZiBhbmQgb25seSBpZiBhbGwgb2YgdGhlIGZvcm0gZ3JvdXAnc1xuICAgKiBjaGlsZCBzdGF0ZXMgYXJlIHByaXN0aW5lLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNQcmlzdGluZTogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgYW5kIG9ubHkgaWYgYXQgbGVhc3Qgb25lIG9mIHRoZSBmb3JtXG4gICAqIGdyb3VwJ3MgY2hpbGQgc3RhdGVzIGlzIG1hcmtlZCBhcyB0b3VjaGVkLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNUb3VjaGVkOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBpZiBhbmQgb25seSBpZiBhbGwgb2YgdGhlIGZvcm0gZ3JvdXAnc1xuICAgKiBjaGlsZCBzdGF0ZXMgYXJlIHVudG91Y2hlZC5cbiAgICovXG4gIHJlYWRvbmx5IGlzVW50b3VjaGVkOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIHNldCB0byBgdHJ1ZWAgYXMgc29vbiBhcyB0aGUgZm9ybSBncm91cCBpc1xuICAgKiBzdWJtaXR0ZWQuIFRoaXMgaXMgdHJhY2tlZCBieSB0aGUgYE5ncnhGb3JtRGlyZWN0aXZlYCwgd2hpY2hcbiAgICogbmVlZHMgdG8gYmUgYXBwbGllZCB0byBhIGZvcm0gbGlrZSB0aGlzOlxuICAgKlxuYGBgaHRtbFxuPGZvcm0gW25ncnhGb3JtU3RhdGVdPVwiZ3JvdXBTdGF0ZVwiPlxuPC9mb3JtPlxuYGBgXG4gICAqXG4gICAqIE5vdGUgdGhhdCBhcHBseWluZyB0aGlzIGRpcmVjdGl2ZSB0byBhIGZvcm0gcHJldmVudHMgbm9ybWFsIGZvcm1cbiAgICogc3VibWlzc2lvbiBzaW5jZSB0aGF0IGRvZXMgbm90IG1ha2UgbXVjaCBzZW5zZSBmb3IgbmdyeCBmb3Jtcy5cbiAgICovXG4gIHJlYWRvbmx5IGlzU3VibWl0dGVkOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBhcyBsb25nIGFzIHRoZSBzdGF0ZSBpcyBub3Qgc3VibWl0dGVkLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNVbnN1Ym1pdHRlZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBjb250YWlucyBhbGwgY2hpbGQgc3RhdGVzIG9mIHRoZSBmb3JtIGdyb3VwLiBBc1xuICAgKiB5b3UgbWF5IGhhdmUgbm90aWNlZCB0aGUgdHlwZSBvZiBlYWNoIGNoaWxkIHN0YXRlIGlzXG4gICAqIGBBYnN0cmFjdENvbnRyb2xTdGF0ZWAgd2hpY2ggc29tZXRpbWVzIGZvcmNlcyB5b3UgdG8gY2FzdCB0aGVcbiAgICogc3RhdGUgZXhwbGljaXRseS4gSXQgaXMgbm90IHBvc3NpYmxlIHRvIGltcHJvdmUgdGhpcyB0eXBpbmdcbiAgICogdW50aWwgW2NvbmRpdGlvbmFsIG1hcHBlZCB0eXBlc10oaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy8xMjQyNClcbiAgICogYXJlIGFkZGVkIHRvIFR5cGVTY3JpcHQuXG4gICAqL1xuICByZWFkb25seSBjb250cm9sczogRm9ybUdyb3VwQ29udHJvbHM8VFZhbHVlPjtcbn1cblxuLyoqXG4gKiBGb3JtIGFycmF5cyBhcmUgY29sbGVjdGlvbnMgb2YgY29udHJvbHMuIFRoZXkgYXJlIHJlcHJlc2VudGVkIGFzXG4gKiBwbGFpbiBzdGF0ZSBhcnJheXMuIFRoZSBzdGF0ZSBvZiBhbiBhcnJheSBpcyBkZXRlcm1pbmVkIGFsbW9zdFxuICogZnVsbHkgYnkgaXRzIGNoaWxkIHN0YXRlcy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGb3JtQXJyYXlTdGF0ZTxUVmFsdWU+IGV4dGVuZHMgQWJzdHJhY3RDb250cm9sU3RhdGU8cmVhZG9ubHkgVFZhbHVlW10+IHtcbiAgLyoqXG4gICAqIFRoZSBhZ2dyZWdhdGVkIHZhbHVlIG9mIHRoZSBmb3JtIGFycmF5LiBUaGUgdmFsdWUgaXMgY29tcHV0ZWQgYnlcbiAgICogYWdncmVnYXRpbmcgdGhlIHZhbHVlcyBvZiBhbGwgY2hpbGRyZW4gaW50byBhbiBhcnJheS5cbiAgICovXG4gIHJlYWRvbmx5IHZhbHVlOiBUVmFsdWVbXTtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgdGhlIGZvcm0gYXJyYXkgZG9lcyBub3QgaGF2ZSBhbnkgZXJyb3JzXG4gICAqIGl0c2VsZiBhbmQgbm9uZSBvZiBpdHMgY2hpbGRyZW4gaGF2ZSBhbnkgZXJyb3JzLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNWYWxpZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgdGhlIGZvcm0gYXJyYXkgb3IgYW55IG9mIGl0cyBjaGlsZHJlblxuICAgKiBoYXZlIGF0IGxlYXN0IG9uZSBlcnJvci5cbiAgICovXG4gIHJlYWRvbmx5IGlzSW52YWxpZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhlIGVycm9ycyBvZiB0aGUgZm9ybSBhcnJheS4gVGhpcyBwcm9wZXJ0eSBpcyBjb21wdXRlZCBieSBtZXJnaW5nXG4gICAqIHRoZSBlcnJvcnMgb2YgdGhlIGFycmF5IHdpdGggdGhlIGVycm9ycyBvZiBhbGwgaXRzIGNoaWxkcmVuIHdoZXJlXG4gICAqIHRoZSBjaGlsZCBlcnJvcnMgYXJlIGEgcHJvcGVydHkgb2YgdGhlIGBlcnJvcnNgIG9iamVjdCBwcmVmaXhlZCB3aXRoXG4gICAqIGFuIHVuZGVyc2NvcmUsIGUuZy5cbiAgICpcbmBgYFxue1xuICBhcnJheUVycm9yOiB0cnVlLFxuICBfMDoge1xuICAgIGNoaWxkRXJyb3I6IHRydWUsXG4gIH0sXG59XG5gYGBcbiAgICpcbiAgICogSWYgbmVpdGhlciB0aGUgYXJyYXkgbm9yIGFueSBjaGlsZHJlbiBoYXZlIGVycm9ycyB0aGUgcHJvcGVydHkgaXNcbiAgICogc2V0IHRvIGB7fWAuXG4gICAqL1xuICByZWFkb25seSBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcnM7XG5cbiAgLyoqXG4gICAqIFRoZSBuYW1lcyBvZiBhbGwgYXN5bmNocm9ub3VzIHZhbGlkYXRpb25zIGN1cnJlbnRseSBydW5uaW5nIGZvciB0aGVcbiAgICogZm9ybSBhcnJheS5cbiAgICovXG4gIHJlYWRvbmx5IHBlbmRpbmdWYWxpZGF0aW9uczogcmVhZG9ubHkgc3RyaW5nW107XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIGFycmF5IG9yIGFueSBvZiBpdHMgY2hpbGRyZW5cbiAgICogYXJlIGN1cnJlbnRseSBiZWluZyBhc3luY2hyb25vdXNseSB2YWxpZGF0ZWQuXG4gICAqL1xuICByZWFkb25seSBpc1ZhbGlkYXRpb25QZW5kaW5nOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGluZGljYXRlcyB3aGV0aGVyIHRoZSBmb3JtIGFycmF5IGlzIGVuYWJsZWQuIEl0IGlzXG4gICAqIGB0cnVlYCBpZiBhbmQgb25seSBpZiBhdCBsZWFzdCBvbmUgb2YgaXRzIGNoaWxkIHN0YXRlcyBpc1xuICAgKiBlbmFibGVkLiBXaGVuIGl0IGlzIGBmYWxzZWAgdGhlIGBlcnJvcnNgIGFyZSBhbHdheXMgYHt9YCAoaS5lLlxuICAgKiB0aGUgZm9ybSBhcnJheSBpcyBhbHdheXMgdmFsaWQgaWYgZGlzYWJsZWQpIGFuZCBgcGVuZGluZ1ZhbGlkYXRpb25zYFxuICAgKiBpcyBhbHdheXMgYFtdYCAoaS5lLiBhbGwgcGVuZGluZyB2YWxpZGF0aW9ucyBhcmUgY2FuY2VsbGVkKS5cbiAgICovXG4gIHJlYWRvbmx5IGlzRW5hYmxlZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpbmRpY2F0ZXMgd2hldGhlciB0aGUgZm9ybSBhcnJheSBpcyBkaXNhYmxlZC4gSXQgaXNcbiAgICogYHRydWVgIGlmIGFuZCBvbmx5IGlmIGFsbCBvZiBpdHMgY2hpbGQgc3RhdGVzIGFyZSBkaXNhYmxlZC4gV2hlblxuICAgKiBpdCBpcyBgdHJ1ZWAgdGhlIGBlcnJvcnNgIGFyZSBhbHdheXMgYHt9YCAoaS5lLiB0aGUgZm9ybSBhcnJheVxuICAgKiBpcyBhbHdheXMgdmFsaWQgaWYgZGlzYWJsZWQpIGFuZCBgcGVuZGluZ1ZhbGlkYXRpb25zYCBpcyBhbHdheXNcbiAgICogYFtdYCAoaS5lLiBhbGwgcGVuZGluZyB2YWxpZGF0aW9ucyBhcmUgY2FuY2VsbGVkKS5cbiAgICovXG4gIHJlYWRvbmx5IGlzRGlzYWJsZWQ6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGlmIGFuZCBvbmx5IGlmIGF0IGxlYXN0IG9uZSBvZiB0aGUgZm9ybVxuICAgKiBhcnJheSdzIGNoaWxkIHN0YXRlcyBpcyBtYXJrZWQgYXMgZGlydHkuXG4gICAqL1xuICByZWFkb25seSBpc0RpcnR5OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBpZiBhbmQgb25seSBpZiBhbGwgb2YgdGhlIGZvcm0gYXJyYXknc1xuICAgKiBjaGlsZCBzdGF0ZXMgYXJlIHByaXN0aW5lLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNQcmlzdGluZTogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgYW5kIG9ubHkgaWYgYXQgbGVhc3Qgb25lIG9mIHRoZSBmb3JtXG4gICAqIGFycmF5J3MgY2hpbGQgc3RhdGVzIGlzIG1hcmtlZCBhcyB0b3VjaGVkLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNUb3VjaGVkOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBpZiBhbmQgb25seSBpZiBhbGwgb2YgdGhlIGZvcm0gYXJyYXknc1xuICAgKiBjaGlsZCBzdGF0ZXMgYXJlIHVudG91Y2hlZC5cbiAgICovXG4gIHJlYWRvbmx5IGlzVW50b3VjaGVkOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIHNldCB0byBgdHJ1ZWAgYXMgc29vbiBhcyB0aGUgZm9ybSBhcnJheSBpc1xuICAgKiBzdWJtaXR0ZWQuIFRoaXMgaXMgdHJhY2tlZCBieSB0aGUgYE5ncnhGb3JtRGlyZWN0aXZlYCwgd2hpY2hcbiAgICogbmVlZHMgdG8gYmUgYXBwbGllZCB0byBhIGZvcm0gbGlrZSB0aGlzOlxuICAgKlxuYGBgaHRtbFxuPGZvcm0gW25ncnhGb3JtU3RhdGVdPVwiYXJyYXlTdGF0ZVwiPlxuPC9mb3JtPlxuYGBgXG4gICAqXG4gICAqIE5vdGUgdGhhdCBhcHBseWluZyB0aGlzIGRpcmVjdGl2ZSB0byBhIGZvcm0gcHJldmVudHMgbm9ybWFsIGZvcm1cbiAgICogc3VibWlzc2lvbiBzaW5jZSB0aGF0IGRvZXMgbm90IG1ha2UgbXVjaCBzZW5zZSBmb3IgbmdyeCBmb3Jtcy5cbiAgICovXG4gIHJlYWRvbmx5IGlzU3VibWl0dGVkOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBhcyBsb25nIGFzIHRoZSBzdGF0ZSBpcyBub3Qgc3VibWl0dGVkLlxuICAgKi9cbiAgcmVhZG9ubHkgaXNVbnN1Ym1pdHRlZDogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhpcyBwcm9wZXJ0eSBjb250YWlucyBhbGwgY2hpbGQgc3RhdGVzIG9mIHRoZSBmb3JtIGFycmF5LiBBc1xuICAgKiB5b3UgbWF5IGhhdmUgbm90aWNlZCB0aGUgdHlwZSBvZiBlYWNoIGNoaWxkIHN0YXRlIGlzXG4gICAqIGBBYnN0cmFjdENvbnRyb2xTdGF0ZWAgd2hpY2ggc29tZXRpbWVzIGZvcmNlcyB5b3UgdG8gY2FzdCB0aGVcbiAgICogc3RhdGUgZXhwbGljaXRseS4gSXQgaXMgbm90IHBvc3NpYmxlIHRvIGltcHJvdmUgdGhpcyB0eXBpbmdcbiAgICogdW50aWwgW2NvbmRpdGlvbmFsIG1hcHBlZCB0eXBlc10oaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy8xMjQyNClcbiAgICogYXJlIGFkZGVkIHRvIFR5cGVTY3JpcHQuXG4gICAqL1xuICByZWFkb25seSBjb250cm9sczogcmVhZG9ubHkgRm9ybVN0YXRlPFRWYWx1ZT5bXTtcbn1cblxuLyoqXG4gKiBUaGlzIGlzIGEgaGVscGVyIHR5cGUgdGhhdCBhbGxvd3Mgd29ya2luZyBhcm91bmQgdGhlIGRpc3RyaWJ1dGl2ZW5lc3NcbiAqIG9mIGNvbmRpdGlvbmFsIHR5cGVzLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEluZmVyZW5jZVdyYXBwZXI8VD4ge1xuICB0OiBUO1xufVxuXG4vKipcbiAqIFRoaXMgaXMgYSBoZWxwZXIgdHlwZSB0aGF0IGluZmVycyB0aGUgY29ycmVjdCBmb3JtIHN0YXRlIHR5cGUgYmFzZWRcbiAqIG9uIHRoZSBib3hlZCB0eXBlIGNvbnRhaW5lZCBpbiB0aGUgaW5mZXJlbmNlIHdyYXBwZXIuXG4gKi9cbmV4cG9ydCB0eXBlIEluZmVycmVkQm94ZWRGb3JtU3RhdGU8VCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8YW55Pj4gPVxuICBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxCb3hlZDxpbmZlciBVPj4gPyBGb3JtQ29udHJvbFN0YXRlPEJveGVkPFU+PlxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPEJveGVkPGluZmVyIFU+IHwgdW5kZWZpbmVkPiA/IEZvcm1Db250cm9sU3RhdGU8Qm94ZWQ8VT4gfCB1bmRlZmluZWQ+XG4gIDogVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8Qm94ZWQ8aW5mZXIgVT4gfCBudWxsPiA/IEZvcm1Db250cm9sU3RhdGU8Qm94ZWQ8VT4gfCBudWxsPlxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPEJveGVkPGluZmVyIFU+IHwgdW5kZWZpbmVkIHwgbnVsbD4gPyBGb3JtQ29udHJvbFN0YXRlPEJveGVkPFU+IHwgdW5kZWZpbmVkIHwgbnVsbD5cbiAgOiBuZXZlclxuICA7XG5cbi8qKlxuICogVGhpcyBpcyBhIGhlbHBlciB0eXBlIHRoYXQgaW5mZXJzIHRoZSBjb3JyZWN0IGZvcm0gc3RhdGUgdHlwZSBiYXNlZFxuICogb24gdGhlIHN0cmluZyB0eXBlIGNvbnRhaW5lZCBpbiB0aGUgaW5mZXJlbmNlIHdyYXBwZXIuXG4gKi9cbmV4cG9ydCB0eXBlIEluZmVycmVkU3RyaW5nRm9ybVN0YXRlPFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPGFueT4+ID1cbiAgVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8c3RyaW5nPiA/IEZvcm1Db250cm9sU3RhdGU8c3RyaW5nPlxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPHN0cmluZyB8IHVuZGVmaW5lZD4gPyBGb3JtQ29udHJvbFN0YXRlPHN0cmluZyB8IHVuZGVmaW5lZD5cbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxzdHJpbmcgfCBudWxsPiA/IEZvcm1Db250cm9sU3RhdGU8c3RyaW5nIHwgbnVsbD5cbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsPiA/IEZvcm1Db250cm9sU3RhdGU8c3RyaW5nIHwgdW5kZWZpbmVkIHwgbnVsbD5cbiAgOiBuZXZlclxuICA7XG5cbi8qKlxuICogVGhpcyBpcyBhIGhlbHBlciB0eXBlIHRoYXQgaW5mZXJzIHRoZSBjb3JyZWN0IGZvcm0gc3RhdGUgdHlwZSBiYXNlZFxuICogb24gdGhlIG51bWJlciB0eXBlIGNvbnRhaW5lZCBpbiB0aGUgaW5mZXJlbmNlIHdyYXBwZXIuXG4gKi9cbmV4cG9ydCB0eXBlIEluZmVycmVkTnVtYmVyRm9ybVN0YXRlPFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPGFueT4+ID1cbiAgVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8bnVtYmVyPiA/IEZvcm1Db250cm9sU3RhdGU8bnVtYmVyPlxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPG51bWJlciB8IHVuZGVmaW5lZD4gPyBGb3JtQ29udHJvbFN0YXRlPG51bWJlciB8IHVuZGVmaW5lZD5cbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxudW1iZXIgfCBudWxsPiA/IEZvcm1Db250cm9sU3RhdGU8bnVtYmVyIHwgbnVsbD5cbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxudW1iZXIgfCB1bmRlZmluZWQgfCBudWxsPiA/IEZvcm1Db250cm9sU3RhdGU8bnVtYmVyIHwgdW5kZWZpbmVkIHwgbnVsbD5cbiAgOiBuZXZlclxuICA7XG5cbi8qKlxuICogVGhpcyBpcyBhIGhlbHBlciB0eXBlIHRoYXQgaW5mZXJzIHRoZSBjb3JyZWN0IGZvcm0gc3RhdGUgdHlwZSBiYXNlZFxuICogb24gdGhlIGJvb2xlYW4gdHlwZSBjb250YWluZWQgaW4gdGhlIGluZmVyZW5jZSB3cmFwcGVyLlxuICovXG5leHBvcnQgdHlwZSBJbmZlcnJlZEJvb2xlYW5Gb3JtU3RhdGU8VCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8YW55Pj4gPVxuICBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxib29sZWFuPiA/IEZvcm1Db250cm9sU3RhdGU8Ym9vbGVhbj5cbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxib29sZWFuIHwgdW5kZWZpbmVkPiA/IEZvcm1Db250cm9sU3RhdGU8Ym9vbGVhbiB8IHVuZGVmaW5lZD5cbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxib29sZWFuIHwgbnVsbD4gPyBGb3JtQ29udHJvbFN0YXRlPGJvb2xlYW4gfCBudWxsPlxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPGJvb2xlYW4gfCB1bmRlZmluZWQgfCBudWxsPiA/IEZvcm1Db250cm9sU3RhdGU8Ym9vbGVhbiB8IHVuZGVmaW5lZCB8IG51bGw+XG4gIDogbmV2ZXJcbiAgO1xuXG4vKipcbiAqIFRoaXMgaXMgYSBoZWxwZXIgdHlwZSB0aGF0IGluZmVycyB0aGUgY29ycmVjdCBmb3JtIHN0YXRlIHR5cGUgYmFzZWRcbiAqIG9uIHRoZSB0eXBlIGNvbnRhaW5lZCBpbiB0aGUgaW5mZXJlbmNlIHdyYXBwZXIuXG4gKi9cbmV4cG9ydCB0eXBlIEluZmVycmVkRm9ybVN0YXRlPFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPGFueT4+ID1cbiAgLy8gKGFiKXVzZSAnc3ltYm9sJyB0byBjYXRjaCAnYW55JyB0eXBpbmdcbiAgVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8c3ltYm9sPiA/IEFic3RyYWN0Q29udHJvbFN0YXRlPGFueT5cbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjx1bmRlZmluZWQ+ID8gQWJzdHJhY3RDb250cm9sU3RhdGU8YW55PlxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPG51bGw+ID8gQWJzdHJhY3RDb250cm9sU3RhdGU8YW55PlxuXG4gIC8vIGNvbnRyb2xcbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxCb3hlZDxhbnk+IHwgdW5kZWZpbmVkIHwgbnVsbD4gPyBJbmZlcnJlZEJveGVkRm9ybVN0YXRlPFQ+XG4gIDogVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8c3RyaW5nIHwgdW5kZWZpbmVkIHwgbnVsbD4gPyBJbmZlcnJlZFN0cmluZ0Zvcm1TdGF0ZTxUPlxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPG51bWJlciB8IHVuZGVmaW5lZCB8IG51bGw+ID8gSW5mZXJyZWROdW1iZXJGb3JtU3RhdGU8VD5cbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxib29sZWFuIHwgdW5kZWZpbmVkIHwgbnVsbD4gPyBJbmZlcnJlZEJvb2xlYW5Gb3JtU3RhdGU8VD5cblxuICAvLyBhcnJheVxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPHJlYWRvbmx5IChpbmZlciBVKVtdIHwgdW5kZWZpbmVkIHwgbnVsbD4gPyBGb3JtQXJyYXlTdGF0ZTxVPlxuXG4gIC8vIGdyb3VwXG4gIDogVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8aW5mZXIgVSB8IHVuZGVmaW5lZCB8IG51bGw+ID8gRm9ybUdyb3VwU3RhdGU8VT5cblxuICAvLyBmYWxsYmFjayB0eXBlICh0aGlzIGNhc2Ugc2hvdWxkIG5ldmVyIChubyBwdW4gaW50ZW5kZWQpIGJlIGhpdClcbiAgOiBuZXZlclxuICA7XG5cbi8qKlxuICogVGhpcyBpcyBhIHR5cGUgdGhhdCBjYW4gaW5mZXIgdGhlIGNvbmNyZXRlIHR5cGUgb2YgYSBmb3JtIHN0YXRlIGJhc2VkXG4gKiBvbiB0aGUgZ2l2ZW4gdHlwZSBwYXJhbWV0ZXIuXG4gKi9cbmV4cG9ydCB0eXBlIEZvcm1TdGF0ZTxUPiA9IEluZmVycmVkRm9ybVN0YXRlPEluZmVyZW5jZVdyYXBwZXI8VD4+O1xuXG4vKipcbiAqIFRoaXMgZnVuY3Rpb24gZGV0ZXJtaW5lcyBpZiBhIHZhbHVlIGlzIGEgZm9ybSBzdGF0ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRm9ybVN0YXRlPFRWYWx1ZSA9IGFueT4oc3RhdGU6IGFueSk6IHN0YXRlIGlzIEZvcm1TdGF0ZTxUVmFsdWU+IHtcbiAgcmV0dXJuICEhc3RhdGUgJiYgc3RhdGUuaGFzT3duUHJvcGVydHkoJ2lkJykgJiYgc3RhdGUuaGFzT3duUHJvcGVydHkoJ3ZhbHVlJykgJiYgc3RhdGUuaGFzT3duUHJvcGVydHkoJ2Vycm9ycycpO1xufVxuXG4vKipcbiAqIFRoaXMgZnVuY3Rpb24gZGV0ZXJtaW5lcyBpZiBhIHZhbHVlIGlzIGFuIGFycmF5IHN0YXRlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBcnJheVN0YXRlPFRWYWx1ZSA9IGFueT4oc3RhdGU6IGFueSk6IHN0YXRlIGlzIEZvcm1BcnJheVN0YXRlPFRWYWx1ZT4ge1xuICByZXR1cm4gaXNGb3JtU3RhdGUoc3RhdGUpICYmIHN0YXRlLmhhc093blByb3BlcnR5KCdjb250cm9scycpICYmIEFycmF5LmlzQXJyYXkoKHN0YXRlIGFzIGFueSkuY29udHJvbHMpO1xufVxuXG4vKipcbiAqIFRoaXMgZnVuY3Rpb24gZGV0ZXJtaW5lcyBpZiBhIHZhbHVlIGlzIGEgZ3JvdXAgc3RhdGUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0dyb3VwU3RhdGU8VFZhbHVlID0gYW55PihzdGF0ZTogYW55KTogc3RhdGUgaXMgRm9ybUdyb3VwU3RhdGU8VFZhbHVlPiB7XG4gIHJldHVybiBpc0Zvcm1TdGF0ZShzdGF0ZSkgJiYgc3RhdGUuaGFzT3duUHJvcGVydHkoJ2NvbnRyb2xzJykgJiYgIUFycmF5LmlzQXJyYXkoKHN0YXRlIGFzIGFueSkuY29udHJvbHMpICYmIHR5cGVvZiAoc3RhdGUgYXMgYW55KS5jb250cm9scyAhPT0gJ2Z1bmN0aW9uJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNoaWxkU3RhdGU8VFZhbHVlPihpZDogc3RyaW5nLCBjaGlsZFZhbHVlOiBUVmFsdWUpOiBGb3JtU3RhdGU8VFZhbHVlPiB7XG4gIGlmIChpc0JveGVkKGNoaWxkVmFsdWUpKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUZvcm1Db250cm9sU3RhdGU8YW55PihpZCwgY2hpbGRWYWx1ZSkgYXMgRm9ybVN0YXRlPFRWYWx1ZT47XG4gIH1cblxuICBpZiAoY2hpbGRWYWx1ZSAhPT0gbnVsbCAmJiBBcnJheS5pc0FycmF5KGNoaWxkVmFsdWUpKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUZvcm1BcnJheVN0YXRlKGlkLCBjaGlsZFZhbHVlKSBhcyBGb3JtU3RhdGU8VFZhbHVlPjtcbiAgfVxuXG4gIGlmIChjaGlsZFZhbHVlICE9PSBudWxsICYmIHR5cGVvZiBjaGlsZFZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBjcmVhdGVGb3JtR3JvdXBTdGF0ZShpZCwgY2hpbGRWYWx1ZSkgYXMgRm9ybVN0YXRlPFRWYWx1ZT47XG4gIH1cblxuICByZXR1cm4gY3JlYXRlRm9ybUNvbnRyb2xTdGF0ZTxhbnk+KGlkLCBjaGlsZFZhbHVlKSBhcyBGb3JtU3RhdGU8VFZhbHVlPjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZlcmlmeUZvcm1Db250cm9sVmFsdWVJc1ZhbGlkPFRWYWx1ZT4odmFsdWU6IFRWYWx1ZSkge1xuICBpZiAodmFsdWUgPT09IG51bGwgfHwgWydzdHJpbmcnLCAnbnVtYmVyJywgJ2Jvb2xlYW4nLCAndW5kZWZpbmVkJ10uaW5kZXhPZih0eXBlb2YgdmFsdWUpID49IDApIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICBpZiAoIWlzQm94ZWQodmFsdWUpKSB7XG4gICAgY29uc3QgZXJyb3JNc2cgPSAnRm9ybSBjb250cm9sIHN0YXRlcyBvbmx5IHN1cHBvcnQgdW5kZWZpbmVkLCBudWxsLCBzdHJpbmcsIG51bWJlciwgYW5kIGJvb2xlYW4gdmFsdWVzIGFzIHdlbGwgYXMgYm94ZWQgdmFsdWVzJztcbiAgICB0aHJvdyBuZXcgRXJyb3IoYCR7ZXJyb3JNc2d9OyBnb3QgJHtKU09OLnN0cmluZ2lmeSh2YWx1ZSl9IG9mIHR5cGUgJHt0eXBlb2YgdmFsdWV9YCk7IC8vIGA7XG4gIH1cblxuICBpZiAodmFsdWUudmFsdWUgPT09IG51bGwgfHwgWydzdHJpbmcnLCAnbnVtYmVyJywgJ2Jvb2xlYW4nLCAndW5kZWZpbmVkJ10uaW5kZXhPZih0eXBlb2YgdmFsdWUudmFsdWUpID49IDApIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICBjb25zdCBzZXJpYWxpemVkID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xuICBjb25zdCBkZXNlcmlhbGl6ZWQgPSBKU09OLnBhcnNlKHNlcmlhbGl6ZWQpO1xuXG4gIGlmIChkZWVwRXF1YWxzKHZhbHVlLCBkZXNlcmlhbGl6ZWQpKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG5cbiAgdGhyb3cgbmV3IEVycm9yKGBBIGZvcm0gY29udHJvbCB2YWx1ZSBtdXN0IGJlIHNlcmlhbGl6YWJsZSAoaS5lLiB2YWx1ZSA9PT0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh2YWx1ZSkpKSwgZ290OiAke0pTT04uc3RyaW5naWZ5KHZhbHVlKX1gKTtcbn1cblxuLyoqXG4gKiBUaGlzIGZ1bmN0aW9uIGNyZWF0ZXMgYSBmb3JtIGNvbnRyb2wgc3RhdGUgd2l0aCBhbiBJRCBhbmQgYSB2YWx1ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUZvcm1Db250cm9sU3RhdGU8VFZhbHVlIGV4dGVuZHMgRm9ybUNvbnRyb2xWYWx1ZVR5cGVzPihcbiAgaWQ6IE5ncnhGb3JtQ29udHJvbElkLFxuICB2YWx1ZTogVFZhbHVlLFxuKTogRm9ybUNvbnRyb2xTdGF0ZTxUVmFsdWU+IHtcbiAgcmV0dXJuIHtcbiAgICBpZCxcbiAgICB2YWx1ZTogdmVyaWZ5Rm9ybUNvbnRyb2xWYWx1ZUlzVmFsaWQodmFsdWUpLFxuICAgIGVycm9yczoge30sXG4gICAgcGVuZGluZ1ZhbGlkYXRpb25zOiBbXSxcbiAgICBpc1ZhbGlkYXRpb25QZW5kaW5nOiBmYWxzZSxcbiAgICBpc1ZhbGlkOiB0cnVlLFxuICAgIGlzSW52YWxpZDogZmFsc2UsXG4gICAgaXNFbmFibGVkOiB0cnVlLFxuICAgIGlzRGlzYWJsZWQ6IGZhbHNlLFxuICAgIGlzRGlydHk6IGZhbHNlLFxuICAgIGlzUHJpc3RpbmU6IHRydWUsXG4gICAgaXNUb3VjaGVkOiBmYWxzZSxcbiAgICBpc1VudG91Y2hlZDogdHJ1ZSxcbiAgICBpc1N1Ym1pdHRlZDogZmFsc2UsXG4gICAgaXNVbnN1Ym1pdHRlZDogdHJ1ZSxcbiAgICBpc0ZvY3VzZWQ6IGZhbHNlLFxuICAgIGlzVW5mb2N1c2VkOiB0cnVlLFxuICAgIHVzZXJEZWZpbmVkUHJvcGVydGllczoge30sXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRGb3JtR3JvdXBWYWx1ZTxUVmFsdWUgZXh0ZW5kcyBLZXlWYWx1ZT4oXG4gIGNvbnRyb2xzOiBGb3JtR3JvdXBDb250cm9sczxUVmFsdWU+LFxuICBvcmlnaW5hbFZhbHVlOiBUVmFsdWUsXG4pOiBUVmFsdWUge1xuICBsZXQgaGFzQ2hhbmdlZCA9IE9iamVjdC5rZXlzKG9yaWdpbmFsVmFsdWUpLmxlbmd0aCAhPT0gT2JqZWN0LmtleXMoY29udHJvbHMpLmxlbmd0aDtcbiAgY29uc3QgbmV3VmFsdWUgPSBPYmplY3Qua2V5cyhjb250cm9scykucmVkdWNlKChyZXMsIGtleToga2V5b2YgVFZhbHVlKSA9PiB7XG4gICAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgb3JpZ2luYWxWYWx1ZVtrZXldICE9PSBjb250cm9sc1trZXldLnZhbHVlO1xuICAgIHJlc1trZXldID0gY29udHJvbHNba2V5XS52YWx1ZTtcbiAgICByZXR1cm4gcmVzO1xuICB9LCB7fSBhcyBUVmFsdWUpO1xuXG4gIHJldHVybiBoYXNDaGFuZ2VkID8gbmV3VmFsdWUgOiBvcmlnaW5hbFZhbHVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Rm9ybUdyb3VwRXJyb3JzPFRWYWx1ZSBleHRlbmRzIEtleVZhbHVlPihcbiAgY29udHJvbHM6IEZvcm1Hcm91cENvbnRyb2xzPFRWYWx1ZT4sXG4gIG9yaWdpbmFsRXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JzLFxuKTogVmFsaWRhdGlvbkVycm9ycyB7XG4gIGxldCBoYXNDaGFuZ2VkID0gZmFsc2U7XG4gIGNvbnN0IGdyb3VwRXJyb3JzID1cbiAgICBPYmplY3Qua2V5cyhvcmlnaW5hbEVycm9ycylcbiAgICAgIC5maWx0ZXIoa2V5ID0+ICFrZXkuc3RhcnRzV2l0aCgnXycpKVxuICAgICAgLnJlZHVjZSgocmVzLCBrZXkpID0+IE9iamVjdC5hc3NpZ24ocmVzLCB7IFtrZXldOiBvcmlnaW5hbEVycm9yc1trZXldIH0pLCB7fSBhcyBWYWxpZGF0aW9uRXJyb3JzKTtcblxuICBjb25zdCBuZXdFcnJvcnMgPSBPYmplY3Qua2V5cyhjb250cm9scykucmVkdWNlKChyZXMsIGtleTogYW55KSA9PiB7XG4gICAgY29uc3QgY29udHJvbEVycm9ycyA9IGNvbnRyb2xzW2tleV0uZXJyb3JzO1xuICAgIGlmICghaXNFbXB0eShjb250cm9sRXJyb3JzKSkge1xuICAgICAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgb3JpZ2luYWxFcnJvcnNbYF8ke2tleX1gXSAhPT0gY29udHJvbEVycm9ycztcbiAgICAgIE9iamVjdC5hc3NpZ24ocmVzLCB7IFtgXyR7a2V5fWBdOiBjb250cm9sc1trZXldLmVycm9ycyB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgb3JpZ2luYWxFcnJvcnMuaGFzT3duUHJvcGVydHkoYF8ke2tleX1gKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzO1xuICB9LCBncm91cEVycm9ycyk7XG5cbiAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgT2JqZWN0LmtleXMob3JpZ2luYWxFcnJvcnMpLmxlbmd0aCAhPT0gT2JqZWN0LmtleXMobmV3RXJyb3JzKS5sZW5ndGg7XG5cbiAgcmV0dXJuIGhhc0NoYW5nZWQgPyBuZXdFcnJvcnMgOiBvcmlnaW5hbEVycm9ycztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVHcm91cFN0YXRlPFRWYWx1ZSBleHRlbmRzIEtleVZhbHVlPihcbiAgaWQ6IHN0cmluZyxcbiAgY29udHJvbHM6IEZvcm1Hcm91cENvbnRyb2xzPFRWYWx1ZT4sXG4gIHZhbHVlOiBUVmFsdWUsXG4gIGVycm9yczogVmFsaWRhdGlvbkVycm9ycyxcbiAgcGVuZGluZ1ZhbGlkYXRpb25zOiByZWFkb25seSBzdHJpbmdbXSxcbiAgdXNlckRlZmluZWRQcm9wZXJ0aWVzOiBLZXlWYWx1ZSxcbiAgZmxhZ3M6IHtcbiAgICB3YXNPclNob3VsZEJlRGlydHk/OiBib29sZWFuO1xuICAgIHdhc09yU2hvdWxkQmVFbmFibGVkPzogYm9vbGVhbjtcbiAgICB3YXNPclNob3VsZEJlVG91Y2hlZD86IGJvb2xlYW47XG4gICAgd2FzT3JTaG91bGRCZVN1Ym1pdHRlZD86IGJvb2xlYW47XG4gIH0sXG4pOiBGb3JtR3JvdXBTdGF0ZTxUVmFsdWU+IHtcbiAgdmFsdWUgPSBnZXRGb3JtR3JvdXBWYWx1ZTxUVmFsdWU+KGNvbnRyb2xzLCB2YWx1ZSk7XG4gIGVycm9ycyA9IGdldEZvcm1Hcm91cEVycm9ycyhjb250cm9scywgZXJyb3JzKTtcbiAgY29uc3QgaXNWYWxpZCA9IGlzRW1wdHkoZXJyb3JzKTtcbiAgY29uc3QgaXNEaXJ0eSA9IGZsYWdzLndhc09yU2hvdWxkQmVEaXJ0eSB8fCBPYmplY3Qua2V5cyhjb250cm9scykuc29tZShrZXkgPT4gY29udHJvbHNba2V5XS5pc0RpcnR5KTtcbiAgY29uc3QgaXNFbmFibGVkID0gZmxhZ3Mud2FzT3JTaG91bGRCZUVuYWJsZWQgfHwgT2JqZWN0LmtleXMoY29udHJvbHMpLnNvbWUoa2V5ID0+IGNvbnRyb2xzW2tleV0uaXNFbmFibGVkKTtcbiAgY29uc3QgaXNUb3VjaGVkID0gZmxhZ3Mud2FzT3JTaG91bGRCZVRvdWNoZWQgfHwgT2JqZWN0LmtleXMoY29udHJvbHMpLnNvbWUoa2V5ID0+IGNvbnRyb2xzW2tleV0uaXNUb3VjaGVkKTtcbiAgY29uc3QgaXNTdWJtaXR0ZWQgPSBmbGFncy53YXNPclNob3VsZEJlU3VibWl0dGVkIHx8IE9iamVjdC5rZXlzKGNvbnRyb2xzKS5zb21lKGtleSA9PiBjb250cm9sc1trZXldLmlzU3VibWl0dGVkKTtcbiAgY29uc3QgaXNWYWxpZGF0aW9uUGVuZGluZyA9IHBlbmRpbmdWYWxpZGF0aW9ucy5sZW5ndGggPiAwIHx8IE9iamVjdC5rZXlzKGNvbnRyb2xzKS5zb21lKGtleSA9PiBjb250cm9sc1trZXldLmlzVmFsaWRhdGlvblBlbmRpbmcpO1xuICByZXR1cm4ge1xuICAgIGlkLFxuICAgIHZhbHVlLFxuICAgIGVycm9ycyxcbiAgICBwZW5kaW5nVmFsaWRhdGlvbnMsXG4gICAgaXNWYWxpZGF0aW9uUGVuZGluZyxcbiAgICBpc1ZhbGlkLFxuICAgIGlzSW52YWxpZDogIWlzVmFsaWQsXG4gICAgaXNFbmFibGVkLFxuICAgIGlzRGlzYWJsZWQ6ICFpc0VuYWJsZWQsXG4gICAgaXNEaXJ0eSxcbiAgICBpc1ByaXN0aW5lOiAhaXNEaXJ0eSxcbiAgICBpc1RvdWNoZWQsXG4gICAgaXNVbnRvdWNoZWQ6ICFpc1RvdWNoZWQsXG4gICAgaXNTdWJtaXR0ZWQsXG4gICAgaXNVbnN1Ym1pdHRlZDogIWlzU3VibWl0dGVkLFxuICAgIHVzZXJEZWZpbmVkUHJvcGVydGllcyxcbiAgICBjb250cm9scyxcbiAgfTtcbn1cblxuLyoqXG4gKiBUaGlzIGZ1bmN0aW9uIGNyZWF0ZXMgYSBmb3JtIGdyb3VwIHN0YXRlIHdpdGggYW4gSUQgYW5kIGEgdmFsdWUuXG4gKiBGcm9tIHRoZSB2YWx1ZSB0aGUgc2hhcGUgb2YgdGhlIGdyb3VwIHN0YXRlIGlzIGluZmVycmVkLCBpLmUuXG4gKiBvYmplY3QgcHJvcGVydGllcyBhcmUgaW5mZXJyZWQgYXMgZm9ybSBncm91cHMsIGFycmF5IHByb3BlcnRpZXNcbiAqIGFyZSBpbmZlcnJlZCBhcyBmb3JtIGFycmF5cywgYW5kIHByaW1pdGl2ZSBwcm9wZXJ0aWVzIGFyZSBpbmZlcnJlZFxuICogYXMgZm9ybSBjb250cm9scy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUZvcm1Hcm91cFN0YXRlPFRWYWx1ZSBleHRlbmRzIEtleVZhbHVlPihcbiAgaWQ6IE5ncnhGb3JtQ29udHJvbElkLFxuICBpbml0aWFsVmFsdWU6IFRWYWx1ZSxcbik6IEZvcm1Hcm91cFN0YXRlPFRWYWx1ZT4ge1xuICBjb25zdCBjb250cm9scyA9IE9iamVjdC5rZXlzKGluaXRpYWxWYWx1ZSlcbiAgICAubWFwKChrZXk6IGtleW9mIFRWYWx1ZSkgPT4gW2tleSwgY3JlYXRlQ2hpbGRTdGF0ZShgJHtpZH0uJHtrZXl9YCwgaW5pdGlhbFZhbHVlW2tleV0pXSBhcyBbc3RyaW5nLCBGb3JtU3RhdGU8YW55Pl0pXG4gICAgLnJlZHVjZSgocmVzLCBbY29udHJvbElkLCBzdGF0ZV0pID0+IE9iamVjdC5hc3NpZ24ocmVzLCB7IFtjb250cm9sSWRdOiBzdGF0ZSB9KSwge30gYXMgRm9ybUdyb3VwQ29udHJvbHM8VFZhbHVlPik7XG5cbiAgcmV0dXJuIGNvbXB1dGVHcm91cFN0YXRlKGlkLCBjb250cm9scywgaW5pdGlhbFZhbHVlLCB7fSwgW10sIHt9LCB7IHdhc09yU2hvdWxkQmVFbmFibGVkOiB0cnVlIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRGb3JtQXJyYXlWYWx1ZTxUVmFsdWU+KFxuICBjb250cm9sczogcmVhZG9ubHkgQWJzdHJhY3RDb250cm9sU3RhdGU8VFZhbHVlPltdLFxuICBvcmlnaW5hbFZhbHVlOiBUVmFsdWVbXSxcbik6IFRWYWx1ZVtdIHtcbiAgbGV0IGhhc0NoYW5nZWQgPSBPYmplY3Qua2V5cyhvcmlnaW5hbFZhbHVlKS5sZW5ndGggIT09IE9iamVjdC5rZXlzKGNvbnRyb2xzKS5sZW5ndGg7XG4gIGNvbnN0IG5ld1ZhbHVlID0gY29udHJvbHMubWFwKChzdGF0ZSwgaSkgPT4ge1xuICAgIGhhc0NoYW5nZWQgPSBoYXNDaGFuZ2VkIHx8IG9yaWdpbmFsVmFsdWVbaV0gIT09IHN0YXRlLnZhbHVlO1xuICAgIHJldHVybiBzdGF0ZS52YWx1ZTtcbiAgfSk7XG5cbiAgcmV0dXJuIGhhc0NoYW5nZWQgPyBuZXdWYWx1ZSA6IG9yaWdpbmFsVmFsdWU7XG59XG5cbmZ1bmN0aW9uIGdldEZvcm1BcnJheUVycm9yczxUVmFsdWU+KFxuICBjb250cm9sczogcmVhZG9ubHkgQWJzdHJhY3RDb250cm9sU3RhdGU8VFZhbHVlPltdLFxuICBvcmlnaW5hbEVycm9yczogVmFsaWRhdGlvbkVycm9ycyxcbik6IFZhbGlkYXRpb25FcnJvcnMge1xuICBsZXQgaGFzQ2hhbmdlZCA9IGZhbHNlO1xuICBjb25zdCBncm91cEVycm9ycyA9XG4gICAgT2JqZWN0LmtleXMob3JpZ2luYWxFcnJvcnMpXG4gICAgICAuZmlsdGVyKGtleSA9PiAha2V5LnN0YXJ0c1dpdGgoJ18nKSlcbiAgICAgIC5yZWR1Y2UoKHJlcywga2V5KSA9PiBPYmplY3QuYXNzaWduKHJlcywgeyBba2V5XTogb3JpZ2luYWxFcnJvcnNba2V5XSB9KSwge30gYXMgVmFsaWRhdGlvbkVycm9ycyk7XG5cbiAgY29uc3QgbmV3RXJyb3JzID0gY29udHJvbHMucmVkdWNlKChyZXMsIHN0YXRlLCBpKSA9PiB7XG4gICAgY29uc3QgY29udHJvbEVycm9ycyA9IHN0YXRlLmVycm9ycztcbiAgICBpZiAoIWlzRW1wdHkoY29udHJvbEVycm9ycykpIHtcbiAgICAgIGhhc0NoYW5nZWQgPSBoYXNDaGFuZ2VkIHx8IG9yaWdpbmFsRXJyb3JzW2BfJHtpfWBdICE9PSBjb250cm9sRXJyb3JzO1xuICAgICAgT2JqZWN0LmFzc2lnbihyZXMsIHsgW2BfJHtpfWBdOiBjb250cm9sRXJyb3JzIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBoYXNDaGFuZ2VkID0gaGFzQ2hhbmdlZCB8fCBvcmlnaW5hbEVycm9ycy5oYXNPd25Qcm9wZXJ0eShgXyR7aX1gKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzO1xuICB9LCBncm91cEVycm9ycyk7XG5cbiAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgT2JqZWN0LmtleXMob3JpZ2luYWxFcnJvcnMpLmxlbmd0aCAhPT0gT2JqZWN0LmtleXMobmV3RXJyb3JzKS5sZW5ndGg7XG5cbiAgcmV0dXJuIGhhc0NoYW5nZWQgPyBuZXdFcnJvcnMgOiBvcmlnaW5hbEVycm9ycztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVBcnJheVN0YXRlPFRWYWx1ZT4oXG4gIGlkOiBzdHJpbmcsXG4gIGluZmVycmVkQ29udHJvbHM6IHJlYWRvbmx5IEZvcm1TdGF0ZTxUVmFsdWU+W10sXG4gIHZhbHVlOiBUVmFsdWVbXSxcbiAgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JzLFxuICBwZW5kaW5nVmFsaWRhdGlvbnM6IHJlYWRvbmx5IHN0cmluZ1tdLFxuICB1c2VyRGVmaW5lZFByb3BlcnRpZXM6IEtleVZhbHVlLFxuICBmbGFnczoge1xuICAgIHdhc09yU2hvdWxkQmVEaXJ0eT86IGJvb2xlYW47XG4gICAgd2FzT3JTaG91bGRCZUVuYWJsZWQ/OiBib29sZWFuO1xuICAgIHdhc09yU2hvdWxkQmVUb3VjaGVkPzogYm9vbGVhbjtcbiAgICB3YXNPclNob3VsZEJlU3VibWl0dGVkPzogYm9vbGVhbjtcbiAgfSxcbik6IEZvcm1BcnJheVN0YXRlPFRWYWx1ZT4ge1xuICBjb25zdCBjb250cm9scyA9IGluZmVycmVkQ29udHJvbHMgYXMgcmVhZG9ubHkgQWJzdHJhY3RDb250cm9sU3RhdGU8YW55PltdO1xuXG4gIHZhbHVlID0gZ2V0Rm9ybUFycmF5VmFsdWU8VFZhbHVlPihjb250cm9scywgdmFsdWUpO1xuICBlcnJvcnMgPSBnZXRGb3JtQXJyYXlFcnJvcnMoY29udHJvbHMsIGVycm9ycyk7XG4gIGNvbnN0IGlzVmFsaWQgPSBpc0VtcHR5KGVycm9ycyk7XG4gIGNvbnN0IGlzRGlydHkgPSBmbGFncy53YXNPclNob3VsZEJlRGlydHkgfHwgY29udHJvbHMuc29tZShzdGF0ZSA9PiBzdGF0ZS5pc0RpcnR5KTtcbiAgY29uc3QgaXNFbmFibGVkID0gZmxhZ3Mud2FzT3JTaG91bGRCZUVuYWJsZWQgfHwgY29udHJvbHMuc29tZShzdGF0ZSA9PiBzdGF0ZS5pc0VuYWJsZWQpO1xuICBjb25zdCBpc1RvdWNoZWQgPSBmbGFncy53YXNPclNob3VsZEJlVG91Y2hlZCB8fCBjb250cm9scy5zb21lKHN0YXRlID0+IHN0YXRlLmlzVG91Y2hlZCk7XG4gIGNvbnN0IGlzU3VibWl0dGVkID0gZmxhZ3Mud2FzT3JTaG91bGRCZVN1Ym1pdHRlZCB8fCBjb250cm9scy5zb21lKHN0YXRlID0+IHN0YXRlLmlzU3VibWl0dGVkKTtcbiAgY29uc3QgaXNWYWxpZGF0aW9uUGVuZGluZyA9IHBlbmRpbmdWYWxpZGF0aW9ucy5sZW5ndGggPiAwIHx8IGNvbnRyb2xzLnNvbWUoc3RhdGUgPT4gc3RhdGUuaXNWYWxpZGF0aW9uUGVuZGluZyk7XG4gIHJldHVybiB7XG4gICAgaWQsXG4gICAgdmFsdWUsXG4gICAgZXJyb3JzLFxuICAgIHBlbmRpbmdWYWxpZGF0aW9ucyxcbiAgICBpc1ZhbGlkYXRpb25QZW5kaW5nLFxuICAgIGlzVmFsaWQsXG4gICAgaXNJbnZhbGlkOiAhaXNWYWxpZCxcbiAgICBpc0VuYWJsZWQsXG4gICAgaXNEaXNhYmxlZDogIWlzRW5hYmxlZCxcbiAgICBpc0RpcnR5LFxuICAgIGlzUHJpc3RpbmU6ICFpc0RpcnR5LFxuICAgIGlzVG91Y2hlZCxcbiAgICBpc1VudG91Y2hlZDogIWlzVG91Y2hlZCxcbiAgICBpc1N1Ym1pdHRlZCxcbiAgICBpc1Vuc3VibWl0dGVkOiAhaXNTdWJtaXR0ZWQsXG4gICAgdXNlckRlZmluZWRQcm9wZXJ0aWVzLFxuICAgIGNvbnRyb2xzOiBpbmZlcnJlZENvbnRyb2xzLFxuICB9O1xufVxuXG4vKipcbiAqIFRoaXMgZnVuY3Rpb24gY3JlYXRlcyBhIGZvcm0gYXJyYXkgc3RhdGUgd2l0aCBhbiBJRCBhbmQgYSB2YWx1ZS5cbiAqIEZyb20gdGhlIHZhbHVlIHRoZSBzaGFwZSBvZiB0aGUgYXJyYXkgc3RhdGUgaXMgaW5mZXJyZWQsIGkuZS5cbiAqIG9iamVjdCB2YWx1ZXMgYXJlIGluZmVycmVkIGFzIGZvcm0gZ3JvdXBzLCBhcnJheSB2YWx1ZXNcbiAqIGFyZSBpbmZlcnJlZCBhcyBmb3JtIGFycmF5cywgYW5kIHByaW1pdGl2ZSB2YWx1ZXMgYXJlIGluZmVycmVkXG4gKiBhcyBmb3JtIGNvbnRyb2xzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRm9ybUFycmF5U3RhdGU8VFZhbHVlPihcbiAgaWQ6IE5ncnhGb3JtQ29udHJvbElkLFxuICBpbml0aWFsVmFsdWU6IFRWYWx1ZVtdLFxuKTogRm9ybUFycmF5U3RhdGU8VFZhbHVlPiB7XG4gIGNvbnN0IGNvbnRyb2xzID0gaW5pdGlhbFZhbHVlXG4gICAgLm1hcCgodmFsdWUsIGkpID0+IGNyZWF0ZUNoaWxkU3RhdGUoYCR7aWR9LiR7aX1gLCB2YWx1ZSkpO1xuXG4gIHJldHVybiBjb21wdXRlQXJyYXlTdGF0ZShpZCwgY29udHJvbHMsIGluaXRpYWxWYWx1ZSwge30sIFtdLCB7fSwgeyB3YXNPclNob3VsZEJlRW5hYmxlZDogdHJ1ZSB9KTtcbn1cbiJdfQ==